\chapter{Exercise 04}
\extitle{Prediction}
\turnindir{ex04}
\exnumber{04}
\exfiles{prediction.py}
\exforbidden{None}
\makeheaderfilesforbidden


% ================================= %
\section*{Objective}
% --------------------------------- %
Understand and manipulate the notion of hypothesis in machine learning.

You must implement the following formula as a function: 

$$
\begin{matrix}
\hat{y}^{(i)} = \theta_0 + \theta_1 x^{(i)} & &\text{ for i = 1, ..., m}
\end{matrix}
$$  

Where:
\begin{itemize}
  \item $\hat{y}^{(i)}$ is the $i^{th}$ component of vector $\hat{y}$
  \item $\hat{y}$ is a vector of dimension $m$, the vector of predicted values
  \item $\theta$ is a vector of dimension $2 \times 1$, the vector of parameters
  \item $x^{(i)}$ is the $i^{th}$ component of vector $x$  
  \item $x$ is a vector of dimension $m$, the vector of examples
\end{itemize}

But this time you have to do it with the linear algebra trick!

$$
\hat{y} = X' \cdot \theta = 
\begin{bmatrix} 
1 & x^{(1)} \\ 
\vdots & \vdots \\ 
1 & x^{(m)} 
\end{bmatrix} 
\cdot
\begin{bmatrix}
\theta_0 \\ 
\theta_1 
\end{bmatrix} 
 = \begin{bmatrix} 
\theta_0 + \theta_1x^{(1)} \\ 
\vdots \\ 
\theta_0 + \theta_1x^{(m)} 
\end{bmatrix} 
$$

\warn{
\begin{itemize}
  \item the argument $x$ is an $m$ vector
  \item $\theta$ is a $2 \times 1$ vector. 
\end{itemize}
}

You have to transform $x$ into $X'$ to fit the dimension of $\theta$!


% ================================= %
\section*{Instructions}
% --------------------------------- %
In the prediction.py file create the following function as per the instructions given below:
\newline
\begin{minted}[bgcolor=darcula-back,formatcom=\color{lightgrey},fontsize=\scriptsize]{python}
def predict_(x, theta):
    """Computes the vector of prediction y_hat from two non-empty numpy.array.
    Args:
      x: has to be an numpy.array, a one-dimensional array of size m.
      theta: has to be an numpy.array, a two-dimensional array of shape 2 * 1.
    Returns:
      y_hat as a numpy.array, a two-dimensional array of shape m * 1.
      None if x and/or theta are not numpy.array.
      None if x or theta are empty numpy.array.
      None if x or theta dimensions are not appropriate.
    Raises:
      This function should not raise any Exceptions.
    """
    ... Your code ...
\end{minted}

\section*{Examples}
\begin{minted}[bgcolor=darcula-back,formatcom=\color{lightgrey},fontsize=\scriptsize]{python}
import numpy as np
x = np.arange(1,6)

# Example 1:
theta1 = np.array([[5], [0]])
predict_(x, theta1)
# Ouput:
array([[5.], [5.], [5.], [5.], [5.]])
# Do you remember why y_hat contains only 5's here?

# Example 2:
theta2 = np.array([[0], [1]])
predict_(x, theta2)
# Output:
array([[1.], [2.], [3.], [4.], [5.]])
# Do you remember why y_hat == x here?

# Example 3:
theta3 = np.array([[5], [3]])
predict_(x, theta3)
# Output:
array([[ 8.], [11.], [14.], [17.], [20.]])


# Example 4:
theta4 = np.array([[-3], [1]])
predict_(x, theta4)
# Output:
array([[-2.], [-1.], [ 0.], [ 1.], [ 2.]])
\end{minted}
