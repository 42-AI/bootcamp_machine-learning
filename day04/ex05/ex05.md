# Exercise 05 - Regularized Logistic Loss Function

|                         |                         |
| -----------------------:| ----------------------- |
|   Turning directory :   |  ex05                   |
|   Files to turn in :    |  reg_log_loss.py        |
|   Forbidden function :  |  None                   |
|   Remarks :             |  n/a                    |

**Objectives:**

You must implement the following formula as a function:  

$$
J(\theta) = \frac{1}{m}\left((-y \cdot \log(h)) - (1 - y) \cdot (1 - log(h))  + \lambda \theta \dot \theta\right) 

J(\theta) = \frac{1}{m}\left((-y^{T}\log(h)) - (1 - y)^{T} (1 - log(h)) + \lambda \theta \dot \theta\right)
$$

where:
- $h = g(X\theta)$ is a vector of dimension m * 1,
- $\theta$ is a vector of dimension n * 1,
- $y$ is a vector of dimension m * 1,
- $\lambda$ is a constant,

**Instructions:**

In the vec_log_loss.py file create the following function as per the instructions below: 
```python
def reg_log_loss_(y_true, y_pred, m, lambda_, eps=1e-15):
    """
    Compute the logistic loss value.
    Args:
        y_true: a scalar or a numpy ndarray for the correct labels
        y_pred: a scalar or a numpy ndarray for the predicted labels
        m: the length of y_true (should also be the length of y_pred)
        lambda_: a float for the regularization parameter
        eps: epsilon (default=1e-15)
    Returns:
        The logistic loss value as a float.
        None on any error.
    Raises:
        This function should not raise any Exception.
    """
```


**Examples:**
```python
import numpy as np
from sigmoid import sigmoid_
from vec_log_loss import vec_log_loss_


# Test n.1
x = 4
y_true = 1
theta = 0.5
y_pred = sigmoid_(x * theta)
m = 1   # length of y_true is 1
print(vec_log_loss_(y_true, y_pred, m))     
# 0.12692801104297152

# Test n.2
x = np.array([1, 2, 3, 4])
y_true = 0
theta = np.array([-1.5, 2.3, 1.4, 0.7])
y_pred = sigmoid_(np.dot(x, theta))
m = 1
print(vec_log_loss_(y_true, y_pred, m))     
# 10.100041078687479

# Test n.3
x_new = np.arange(1, 13).reshape((3, 4))
y_true = np.array([1, 0, 1])
theta = np.array([-1.5, 2.3, 1.4, 0.7])
y_pred = sigmoid_(np.dot(x_new, theta))
m = len(y_true)
print(vec_log_loss_(y_true, y_pred, m))     
# 7.233346147374828
```
